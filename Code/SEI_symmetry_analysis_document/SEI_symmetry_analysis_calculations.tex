% -----------------------------------------------------------------------
% DEFINE DOCUMENT
% -----------------------------------------------------------------------
% Define if you want an article, beamer, a book, a letter etc.
\documentclass[12pt]{article}
% -----------------------------------------------------------------------
% LOAD PACKAGES
% -----------------------------------------------------------------------
\usepackage[utf8]{inputenc} % Standard writing
% General document formatting
\usepackage[margin=1in]{geometry}
% \usepackage[parfill]{parskip} % To skip indentation
\usepackage[utf8]{inputenc}
% Related to math
\usepackage{amsmath,amssymb,amsfonts,amsthm}
% Some more mathematical symbols
\usepackage{mathtools}
% For referencing footnotes
\usepackage[symbol]{footmisc}
% In order to write derivatives quickly and nicely
\usepackage{physics}
% In order to include figures
\usepackage{graphicx}
% To write an algorithm
\usepackage[ruled,vlined]{algorithm2e}
% To add todo lists
\usepackage[colorinlistoftodos]{todonotes}
% -----------------------------------------------------------------------
% GENERAL FORMATTING
% -----------------------------------------------------------------------
% Setting length of the margins
\setlength {\marginparwidth }{2cm}
% For mathematics
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
% To define the footnotes
\renewcommand{\thefootnote}{\fnsymbol{footnote}}
% Define inputs and outputs for the algorithm
\SetKwInput{KwInput}{Input}
\SetKwInput{KwOutput}{Output}
% Set the graphics-path, i.e. where we store the figures
%\graphicspath{{./images/}}
% -----------------------------------------------------------------------
% DOCUMENT BEGINS
% -----------------------------------------------------------------------
\begin{document}
\title{A symmetry-based structural SI analysis of the SEI model}
\author{Johannes G. Borgqvist}
\date{\today}
\maketitle
% -----------------------------------------------------------------------
% Automated notes generated from SymPy
% -----------------------------------------------------------------------
\section{Automated notes generated by the SymPy-based script}
\input{./notes.tex}
% -----------------------------------------------------------------------
% Nicely typed notes in a coherent text
% -----------------------------------------------------------------------
\section{Symmetry-based local SI analysis of the SEI model}
We consider the following SEI model of epidemiological transmission of tuberculosis:
\begin{align}
  \dot{S} &= - \beta I S + c - \mu_{S} S\,,\label{eq:ODE_S}\\
  \dot{E} &= \beta \left(1 - \upsilon\right) I S - \delta E - \mu_{E} E\,,\label{eq:ODE_E}\\
  \dot{I} &= \beta \upsilon I S + \delta E - \mu_{I} I\,.\label{eq:ODE_I}
\end{align}
We also observe the following two outputs
\begin{align}
  y_{E}&=k_{E}E\,,\label{eq:output_E}\\
  y_{I}&=k_{I}I\,,\label{eq:output_I}  
\end{align}
and their interpretation is that we observe proportions $k_{E}$ and $k_{I}$ of the exposed and infected populations, respectively. In total, we have nine parameters collected in the vector $\boldsymbol{\theta}\in\mathbb{R}^{9}$ which are given by
\begin{equation}
\boldsymbol{\theta}=\begin{pmatrix}c\\\beta\\\mu_{S}\\\mu_{E}\\\mu_{I}\\\delta\\\upsilon\\k_{E}\\k_{I}\end{pmatrix}\,.
  \label{eq:param_SEI}
\end{equation}
We are looking for a family of infinitesimal generators of the Lie group given by
\begin{equation}
  \begin{split}
    X&=\xi(t,S,E,I,\boldsymbol{\theta})\partial_{t}+\eta_{S}(t,S,E,I,\boldsymbol{\theta})\partial_{t}+\eta_{E}(t,S,E,I,\boldsymbol{\theta})\partial_{t}+\eta_{I}(t,S,E,I,\boldsymbol{\theta})\partial_{t}\\
    &\quad+\chi_{c}(\boldsymbol{\theta})\partial_{c}+\chi_{\beta}(\boldsymbol{\theta})\partial_{\beta}+\chi_{\mu_{S}}(\boldsymbol{\theta})\partial_{\mu_{S}}+\chi_{\mu_{E}}(\boldsymbol{\theta})\partial_{\mu_{E}}+\chi_{\mu_{I}}(\boldsymbol{\theta})\partial_{\mu_{I}}+\chi_{\delta}(\boldsymbol{\theta})\partial_{\mu_{\delta}}\\
    &\quad+\chi_{\upsilon}(\boldsymbol{\theta})\partial_{\mu_{\upsilon}}+\chi_{k_{E}}(\boldsymbol{\theta})\partial_{k_{E}}+\chi_{k_{I}}(\boldsymbol{\theta})\partial_{k_{I}}\,.
    \end{split}
  \label{eq:X_SEI_original}
\end{equation}
The three first prolongations are given by
\begin{align}
  \eta_{S}^{(1)}(t,S,E,I,\dot{S},\boldsymbol{\theta})&=D_{t}\eta_{S}(t,S,E,I,\boldsymbol{\theta})-\dot{S}D_{t}\xi(t,S,E,I,\boldsymbol{\theta})\label{eq:eta_S_1}\,,\\
  \eta_{E}^{(1)}(t,S,E,I,\dot{E},\boldsymbol{\theta})&=D_{t}\eta_{E}(t,S,E,I,\boldsymbol{\theta})-\dot{E}D_{t}\xi(t,S,E,I,\boldsymbol{\theta})\label{eq:eta_E_1}\,,\\
\eta_{I}^{(1)}(t,S,E,I,\dot{S},\boldsymbol{\theta})&=D_{t}\eta_{I}(t,S,E,I,\boldsymbol{\theta})-\dot{I}D_{t}\xi(t,S,E,I,\boldsymbol{\theta})\label{eq:eta_I_1}\,,
\end{align}
where the total derivative is defined by: $D_{t}=\partial_{t}+\dot{S}\partial_{S}+\dot{E}\partial_{E}+\dot{I}\partial_{I}$. These prolongations define the first prolongation of the infinitesimal generator $X^{(1)}$ according to
\begin{equation}
  X^{(1)}=X+\eta_{S}^{(1)}\partial_{\dot{S}}+\eta_{E}^{(1)}\partial_{\dot{E}}+\eta_{I}^{(1)}\partial_{\dot{I}}\,.
  \label{eq:X_1_SEI}
\end{equation}
Before, we define the linearised symmetry conditions, we make two critical simplifications. First, the model of interest is autonomous which implies that the time infinitesimal is a constant, i.e. $\xi(t,S,E,I)=K$ for some $K\in\mathbb{R}$ and thus $D_{t}\xi=0$.

Second, the fact that the observed outputs are differential invariants of our generator yields equations for the infinitesimals $\eta_{E}$ and $\eta_{I}$, respectively. Starting with the infinitesimal for $E$, we have that
$$X(y_{E})=0\Longrightarrow\quad{k_{E}}\eta_{E}+\chi_{K_{E}}E=0\,,$$
which gives us the following equation for $\eta_{E}$
\begin{equation}
  \eta_{E}=-\left(\dfrac{\chi_{k_{E}}}{k_{E}}\right)E\,.
  \label{eq:eta_E}
\end{equation}
Analogously, the equation for $\eta_{I}$ is given by
\begin{equation}
  \eta_{I}=-\left(\dfrac{\chi_{k_{I}}}{k_{I}}\right)I\,.
  \label{eq:eta_I}
\end{equation}
Thus the corresponding prolongations simplify to
\begin{align}
\eta_{E}^{(1)}&=-\left(\dfrac{\chi_{k_{E}}}{k_{E}}\right)\dot{E}\,.\label{eq:eta_E_prolong}\\
  \eta_{I}^{(1)}&=-\left(\dfrac{\chi_{k_{I}}}{k_{I}}\right)\dot{I}\,.\label{eq:eta_I_prolong}
\end{align}
% -----------------------------------------------------------------------
% DOCUMENT ENDS
% -----------------------------------------------------------------------
\end{document}
